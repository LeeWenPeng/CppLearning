## 1  进程

进程是资源调度的基本单位

资源包括

- 独立的内存空间
- 文件描述符表
- 环境变量
- 信号处理表
- 等

目的：提供隔离的执行环境

- 每个进程创建时，操作系统都会提供独立的资源集合
- 通过进程控制块（PCB）来记录资源状态
- 一个进程宕机时，不会影响其他进程的正常运行

## 2  线程

线程是 CPU 调度的基本单位

资源包括

- 共享的进程资源
- 独立线程资源
	- 线程号
	- 栈内存空间
	- 程序计数器
	- 寄存器集合

目的：快速切换执行流，且切换开销尽可能小

- 共享进程资源
- 通过线程控制块（TCB）记录调度进程所需的必需信息，也就是执行流的必要信息
- 在 C++ 中，一个线程崩溃，可能导致整个进程终止，也就是说，会影响其他的线程

## 3  进程和线程的区别

![进程和线程的空间*1000](进程和线程的区别？如何使用多进程和多线程？/进程和线程的空间.md)

### 3.1  资源的区别

- 一个线程一般属于一个进程，一个进程可以拥有多个线程
- 进程具有独立的资源集合，包括内存、文件描述符、环境变量、信号处理器等
- 同一个进程下的多线程，共享进程的资源，并具有少量独立资源，包括栈、程序计数器、本地存储等
- 进程和线程的通信方式不同

### 3.2  切换效率

- 多进程切换需要刷新 TLB，并获取新的地址空间，然后切换硬件上下文和内核栈
- 而多线程的切换效率较高，只需要切换硬件上下文、线程控制块和线程私有栈等线程独占资源

### 3.3  健壮性

- 进程健壮性较强，因为当一个进程宕机时，不影响其他进程的运行
- 线程健壮性较低，因为当一个线程宕机时，可能整个进程也会随之崩溃，从而导致同一个进程下的其他的线程也无法执行

### 3.4  适用场景

- 具有安全、隔离需求，推荐多进程
	- 安全关键应用：浏览器，每一个标签页一个应用
	- 故障隔离需求：数据库连接池，每个连接一个进程
	- 异构系统集成：微服务架构中不同的服务
	- 资源配额控制：需要限制 CPU 或内存使用的应用
- 有效率、数据共享需求，推荐多线程
	- 计算密集型任务：科学计算、图像处理
	- I/O 密集型任务：Web 服务器
	- 实时响应需求：GUI 应用程序
	- 共享数据结构：内存数据库、缓存系统
- 对于计算机硬件环境而言
	- 进程适用于多核、多机
	- 线程适用于多核

## 4  进程和线程如何配合使用

在多进程情况下时，可以将每一个进程展开为多线程进行性能优化
